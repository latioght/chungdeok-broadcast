<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì¶©ë•ì¤‘ ë°©ì†¡ë¶€ ë°©ëª…ë¡</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- âœ… Firebase SDK (Compat ë°©ì‹) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-50 text-gray-800 p-6">

  <h1 class="text-2xl font-bold mb-6">âœ‰ï¸ ì¶©ë•ì¤‘ ë°©ì†¡ë¶€ ì‘ì› ë°©ëª…ë¡</h1>

  <!-- âœ… ì‚¬ìš©ì ì…ë ¥ í¼ -->
  <form id="guestbook-form" class="space-y-4 max-w-md">
    <input type="text" id="name" placeholder="ì´ë¦„" required class="w-full p-2 border rounded">
    <textarea id="message" rows="4" placeholder="ì‘ì› ë©”ì‹œì§€ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”" required class="w-full p-2 border rounded"></textarea>
    <button type="submit" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">ì‘ì› ë‚¨ê¸°ê¸°</button>
  </form>

  <!-- âœ… ì‘ì„±ëœ ë©”ì‹œì§€ ëª©ë¡ -->
  <div class="mt-10">
    <h2 class="text-xl font-bold mb-4">ğŸ’¬ ì‹¤ì‹œê°„ ì‘ì› ë©”ì‹œì§€</h2>
    <ul id="guestbook-list" class="space-y-2 text-sm"></ul>
  </div>

  <!-- âœ… Firebase ì—°ë™ + ì‹¤ì‹œê°„ ì €ì¥ ì½”ë“œ -->
  <script>
    // ğŸ” Firebase ì„¤ì • (ë‹¹ì‹ ì´ ì œê³µí•œ ê°’ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
    const firebaseConfig = {
      apiKey: "AIzaSyCOkEgw1nSpwkDAUxo4djquNQCfkuue3B0",
      authDomain: "chungdeok-guestbook.firebaseapp.com",
      projectId: "chungdeok-guestbook",
      storageBucket: "chungdeok-guestbook.firebasestorage.app",
      messagingSenderId: "806335367334",
      appId: "1:806335367334:web:246210467df441deae4c67",
      measurementId: "G-H6YN6MR0H2"
    };

    // ğŸ”§ ì´ˆê¸°í™”
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // âœ… ì…ë ¥ ë° ì €ì¥
    const form = document.getElementById('guestbook-form');
    const list = document.getElementById('guestbook-list');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const message = document.getElementById('message').value.trim();

      if (name && message) {
        await db.collection("guestbook").add({
          name,
          message,
          timestamp: Date.now()
        });

        form.reset();
        loadMessages();
      }
    });

    // âœ… ë©”ì‹œì§€ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadMessages() {
      const snapshot = await db.collection("guestbook").orderBy("timestamp", "desc").get();
      list.innerHTML = "";
      snapshot.forEach(doc => {
        const data = doc.data();
        const li = document.createElement("li");
        li.className = "bg-white p-3 rounded shadow";
        li.innerHTML = `<strong>${data.name}</strong>: ${data.message}`;
        list.appendChild(li);
      });
    }

    loadMessages();
  </script>
</body>
</html>
